<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Algorithmic Trading</title>
</head>
<body onload="server.training_status_box_update('t_status',
                    't_ds_select', 'm_name_input','train_button',
                    'neurons_per_layer_select','number_of_layers_select',
                    'output_estimation_span_select',
                    'checkbox_putt_call',
                    'checkbox_junk_bond_demand',
                    'checkbox_mcclellan_summation_index',
                    'checkbox_lag_time',
                    'lag_time_select')">

<table>
    <tr>
        <th><h2 style="text-decoration: underline;">
            Training Your Classification Network</h2></th>
    </tr>
    <tr>
        <td>
        </td>
        <td>
            <p>Create Model Name</p>
            <input type="text" id="m_name_input"
                   onkeyup="enableTrainButton()"
                   style="width:230px;height:20px;line-height:1em;
                   color:black;padding:1px;resize:none;">
        </td>
    </tr>
    <tr>
        <td>
            <!--The title of this section will be used as an interlock variable
                to ensure at least one input is selected for dataset generation
                ...the 'Generate Dataset' button will only be enabled when
                at least one input selection checkbox is checked and the user
                has specified a name for the new dataset. -->
            <p id="input_interlock" value="False">
                What inputs would you like to use to create your dataset?</p>
            <input type="checkbox" id="checkbox_putt_call"
                name="checkbox_putt_call" value="False"
                onclick="setInputInterlock(this)">
            <span>- Putt/Call Ratios</span>
            <br>
            <input type="checkbox" id="checkbox_junk_bond_demand"
                name="checkbox_junk_bond_demand" value="False"
                onclick="setInputInterlock(this)">
            <span>- Junk Bond Demand</span>
            <br>
            <input type="checkbox" id="checkbox_mcclellan_summation_index"
                name="checkbox_mcclellan_summation_index" value="False"
                onclick="setInputInterlock(this)">
            <span>- McClellan Summation Index</span>
            <br>
            <input type="checkbox" id="checkbox_lag_time"
                name="checkbox_lag_time" value="False"
                onclick="setLagTimeInterlock(this), setInputInterlock(this)">
            <span>- Lag Time of </span>
            <select name="lag_time_select" id="lag_time_select" disabled>
              <option value="{{lag_time_values[0]}}" selected>
                                {{lag_time_values[0]}}</option>
              {% for lag_time_value in lag_time_values[1:] %}
                <option value="{{lag_time_value}}">{{lag_time_value}}</option>
              {% endfor %}
            </select>
            <span> Days</span>
        </td>
        <td>
        </td>
    </tr>
    <tr>
        <td>
        <br>
            <span>
                How many neurons per layer you would like your model to have?
            </span>
            <br>
            <br>
            <select style="width:50px"  name="neurons_per_layer_select"
                    id="neurons_per_layer_select" >
              <option value="{{neurons_per_layer_values[0]}}" selected>
                                {{neurons_per_layer_values[0]}}
              </option>
              {% for neurons_per_layer_value in neurons_per_layer_values[1:] %}
                <option value="{{neurons_per_layer_value}}">
                    {{neurons_per_layer_value}}
                </option>
              {% endfor %}
            </select>
            <span> Neurons</span>
            <br>
            <br>
            <br>
            <span>
                How many layers of neurons would you like your model to have?
            </span>
            <br>
            <br>
            <select style="width:50px"  name="number_of_layers_select"
                    id="number_of_layers_select">
              <option value="{{number_of_layers_values[0]}}" selected>
                                {{number_of_layers_values[0]}}
              </option>
              {% for number_of_layers_value in number_of_layers_values[1:] %}
                <option value="{{number_of_layers_value}}">
                    {{number_of_layers_value}}
                </option>
              {% endfor %}
            </select>
            <span> Layers</span>
             <br>
            <br>
            <br>
            <span>
                How far into the future would like your model to predict?
            </span>
            <br>
            <br>
            <select style="width:50px"  name="output_estimation_span_select"
                    id="output_estimation_span_select">
              <option value="{{output_estimation_span_values[0]}}" selected>
                                {{output_estimation_span_values[0]}}
              </option>
              {% for output_estimation_span_value in
                                           output_estimation_span_values[1:] %}
                <option value="{{output_estimation_span_value}}">
                    {{output_estimation_span_value}}
                </option>
              {% endfor %}
            </select>
            <span> Days</span>
        </td>
        <td>
            <button id="train_button"
                    onclick="
                    server.store_user_training_choices('t_status',
                    'm_name_input','train_button',
                    'checkbox_putt_call','checkbox_junk_bond_demand',
                    'checkbox_mcclellan_summation_index',
                    'checkbox_lag_time','lag_time_select',
                    'neurons_per_layer_select','number_of_layers_select',
                    'output_estimation_span_select'),
                    server.disable_training_user_input('t_status',
                    't_ds_select', 'm_name_input','train_button',
                    'neurons_per_layer_select','number_of_layers_select',
                    'output_estimation_span_select'),
                    clearTrainingStatusBox()" disabled>Train</button>
            <br>
            <br>
            <textarea readonly id="t_status" style="width:190px;height:150px;
                line-height:1em; color:dimgrey;padding:1px;resize:none;">
            </textarea>
        </td>
    </tr>
    <tr>
        <td>
        </td>
        <td>
            <button id="c_button" onclick="server.status_update('t_status')"
                    disabled>Cancel Training</button>
            <input type="checkbox" id="cancel_interlock"
                   name="cancel_interlock" value="cancel_ok"
                   onclick="enableCancelButton(this)">
            Enable Cancel?
        </td>
    </tr>
</table>
<br>
</body>

<script>
    // source: https://www.encodedna.com/javascript/
    // disable-or-enable-submit-button-using-javascript.htm
    function enableTrainButton(){
        let m_name_input = document.getElementById('m_name_input').value;
        let t_button = document.getElementById('train_button');
        if (m_name_input.value != ''&&
            document.getElementById('input_interlock').value === 'True') {
            t_button.disabled = false;
        }
        else {
            t_button.disabled = true;
        }
    }

    function enableCancelButton(cancel_interlock) {
        let c_button = document.getElementById('c_button');
        if (cancel_interlock.checked) {
            c_button.disabled = false;
        } else {
            c_button.disabled = true;
        }
    }

    function clearTrainingStatusBox(){
        document.getElementById('t_status').innerHTML = ""
    }

    function setInputInterlock(input_option_checkbox){
        if (input_option_checkbox.checked){
            input_option_checkbox.value = "True";
            document.getElementById('input_interlock').value = 'True'

            // This function call will attempt to enable the 'Generate Dataset'
            // button, in order for that button to be enabled... the user must
            // at least select one input and a Dataset name.
            enableTrainButton()
        } else{
            // Set this checkbox to false if it was unchecked by the user
           input_option_checkbox.value = "False";

        // Get all the checkboxes status by looping through a list.
        // this also checks for any checkmarks that have already been checked
        // if one is found 'any_checked' is set to true.  This will be used
        // further down when determining what the status of the
        // 'input_interlock' value should be.  This interlock is one of the two
        // interlocks that must be satisfied in order for the
        // 'Generate Dataset' button to be enabled.
        // (the other is 'Dataset Name')
            let any_checked = false
            const check_box_id_array = ["checkbox_putt_call",
                                        "checkbox_junk_bond_demand",
                                        "checkbox_mcclellan_summation_index",
                                        "checkbox_lag_time"]

            for (let i = 0; i < check_box_id_array.length; i++) {
                if (document.getElementById(check_box_id_array[i]).value
                                                                === "True") {
                    any_checked = true
                }
            }
            if (any_checked === false) {
                document.getElementById('input_interlock').value = 'False'
                enableTrainButton()
            }
        }
    }

    // This little function enables/disables the lag time selector when the Lag Time
    // check mark is checked by the user.
    function setLagTimeInterlock(checkbox_lag_time){
        if (checkbox_lag_time.checked){
            document.getElementById('lag_time_select').disabled = false
        }else{
            document.getElementById('lag_time_select').disabled = true
        }
    }

    function forceReload(){
        window.location.reload( true )
    }
</script>
</html>